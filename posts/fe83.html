<!-- build time:Thu Jun 04 2020 17:17:58 GMT+0800 (CST) --><!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="Linuxå†…æ ¸ä¸­makefileæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿæ·±å…¥è§£æmakefileå·¥ä½œè¿‡ç¨‹å’ŒåŸç†, xiangyi"><meta name="description" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>Linuxå†…æ ¸ä¸­makefileæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿæ·±å…¥è§£æmakefileå·¥ä½œè¿‡ç¨‹å’ŒåŸç† | xiangyi</title><link rel="icon" type="image/png" href="/medias/logo.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="xiangyi" type="application/atom+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/kenan2.png" class="logo-img" alt="LOGO"> <span class="logo-span">xiangyi</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>é¦–é¡µ</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>æ ‡ç­¾</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>åˆ†ç±»</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>å½’æ¡£</span></a></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fa fa-list" style="zoom:.6"></i> <span>åª’ä½“</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/books"><i class="fas fa-book" style="margin-top:-20px;zoom:.6"></i> <span>é˜…è¯»</span></a></li><li><a href="/movies"><i class="fas fa-film" style="margin-top:-20px;zoom:.6"></i> <span>ç”µå½±</span></a></li><li><a href="/games"><i class="fas fa-gamepad" style="margin-top:-20px;zoom:.6"></i> <span>æ¸¸æˆ</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>å…³äº</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/about-me"><i class="fas fa-user" style="margin-top:-20px;zoom:.6"></i> <span>æˆ‘?</span></a></li><li><a href="/about"><i class="fas fa-coffee" style="margin-top:-20px;zoom:.6"></i> <span>æœ¬ç«™</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>ç•™è¨€æ¿</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>å‹æƒ…é“¾æ¥</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/box" class="waves-effect waves-light"><i class="fas fa-truck" style="zoom:.6"></i> <span>æ‚è´§é“º</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/kenan2.png" class="logo-img circle responsive-img"><div class="logo-name">xiangyi</div><div class="logo-desc">Never really desperate, only the lost of the soul.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> é¦–é¡µ</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> æ ‡ç­¾</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> åˆ†ç±»</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> å½’æ¡£</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fa fa-list"></i> åª’ä½“ <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/books" style="margin-left:75px"><i class="fa fas fa-book" style="position:absolute;left:50px"></i> <span>é˜…è¯»</span></a></li><li><a href="/movies" style="margin-left:75px"><i class="fa fas fa-film" style="position:absolute;left:50px"></i> <span>ç”µå½±</span></a></li><li><a href="/games" style="margin-left:75px"><i class="fa fas fa-gamepad" style="position:absolute;left:50px"></i> <span>æ¸¸æˆ</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-user-circle"></i> å…³äº <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/about-me" style="margin-left:75px"><i class="fa fas fa-user" style="position:absolute;left:50px"></i> <span>æˆ‘?</span></a></li><li><a href="/about" style="margin-left:75px"><i class="fa fas fa-coffee" style="position:absolute;left:50px"></i> <span>æœ¬ç«™</span></a></li></ul></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> ç•™è¨€æ¿</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> å‹æƒ…é“¾æ¥</a></li><li class="m-nav-item"><a href="/box" class="waves-effect waves-light"><i class="fa-fw fas fa-truck"></i> æ‚è´§é“º</a></li></ul></div></div></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(https://i.loli.net/2020/02/19/TVpeNKxw3ya5CFW.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">Linuxå†…æ ¸ä¸­makefileæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿæ·±å…¥è§£æmakefileå·¥ä½œè¿‡ç¨‹å’ŒåŸç†</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/%E8%BD%AC%E8%BD%BD/"><span class="chip bg-color">è½¬è½½</span> </a><a href="/tags/makefile/"><span class="chip bg-color">makefile</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Linux/" class="post-category">Linux</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp; 2020-05-26</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp; 2.6k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp; 10 åˆ†</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><p>&emsp;&emsp;Linuxå†…æ ¸ä¸­Makefile çš„ä½œç”¨æ˜¯æ ¹æ®é…ç½®çš„æƒ…å†µï¼Œæ„é€ å‡ºéœ€è¦ç¼–è¯‘çš„æºæ–‡ä»¶åˆ—è¡¨ï¼Œç„¶ååˆ†åˆ«ç¼–è¯‘ï¼Œå¹¶æŠŠç›®æ ‡ä»£ç é“¾æ¥åˆ°ä¸€èµ·ï¼Œæœ€ç»ˆå½¢æˆ linux å†…æ ¸äºŒè¿›åˆ¶æ–‡ä»¶ã€‚<br>&emsp;&emsp;ç”±äº Linux å†…æ ¸æºä»£ç æ˜¯æŒ‰ç…§æ ‘å½¢ç»“æ„ç»„ç»‡çš„ï¼Œæ‰€ä»¥ Makefile ä¹Ÿè¢«åˆ†å¸ƒåœ¨ç›®å½•æ ‘ä¸­ã€‚Linux å†…æ ¸ä¸­çš„ Makefile ä»¥åŠä¸ Makefile ç›´æ¥ç›¸å…³çš„æ–‡ä»¶æœ‰ï¼š<br>1. Makefileï¼šé¡¶å±‚ Makefileï¼Œæ˜¯æ•´ä¸ªå†…æ ¸é…ç½®ã€ç¼–è¯‘çš„æ€»ä½“æ§åˆ¶æ–‡ä»¶ã€‚<br>2. configï¼šå†…æ ¸é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«ç”±ç”¨æˆ·é€‰æ‹©çš„é…ç½®é€‰é¡¹ï¼Œç”¨æ¥å­˜æ”¾å†…æ ¸é…ç½®åçš„ç»“æœï¼ˆå¦‚ make configï¼‰ã€‚<br>3. arch/*/Makefileï¼šä½äºå„ç§ CPU ä½“ç³»ç›®å½•ä¸‹çš„ Makefileï¼Œå¦‚ arch/arm/Makefileï¼Œæ˜¯é’ˆå¯¹ç‰¹å®šå¹³å°çš„ Makefileã€‚<br>4. å„ä¸ªå­ç›®å½•ä¸‹çš„ Makefileï¼šæ¯”å¦‚ drivers/Makefileï¼Œè´Ÿè´£æ‰€åœ¨å­ç›®å½•ä¸‹æºä»£ç çš„ç®¡ç†ã€‚<br>5. Rules.makeï¼šè§„åˆ™æ–‡ä»¶ï¼Œè¢«æ‰€æœ‰çš„ Makefile ä½¿ç”¨ã€‚<br>&emsp;&emsp;ç”¨æˆ·é€šè¿‡ make config é…ç½®åï¼Œäº§ç”Ÿäº† .configã€‚é¡¶å±‚ Makefile è¯»å…¥ .config ä¸­çš„é…ç½®é€‰æ‹©ã€‚é¡¶å±‚ Makefile æœ‰ä¸¤ä¸ªä¸»è¦çš„ä»»åŠ¡ï¼šäº§ç”Ÿ vmlinux æ–‡ä»¶å’Œå†…æ ¸æ¨¡å—ï¼ˆmoduleï¼‰ã€‚ä¸ºäº†è¾¾åˆ°æ­¤ç›®çš„ï¼Œé¡¶å±‚ Makefile é€’å½’çš„è¿›å…¥åˆ°å†…æ ¸çš„å„ä¸ªå­ç›®å½•ä¸­ï¼Œåˆ†åˆ«è°ƒç”¨ä½äºè¿™äº›å­ç›®å½•ä¸­çš„ Makefileã€‚è‡³äºåˆ°åº•è¿›å…¥å“ªäº›å­ç›®å½•ï¼Œå–å†³äºå†…æ ¸çš„é…ç½®ã€‚åœ¨é¡¶å±‚ Makefile ä¸­ï¼Œæœ‰ä¸€å¥ï¼šinclude arch/$(ARCH)/Makefileï¼ŒåŒ…å«äº†ç‰¹å®š CPU ä½“ç³»ç»“æ„ä¸‹çš„ Makefileï¼Œè¿™ä¸ª Makefile ä¸­åŒ…å«äº†å¹³å°ç›¸å…³çš„ä¿¡æ¯ã€‚<br>&emsp;&emsp;ä½äºå„ä¸ªå­ç›®å½•ä¸‹çš„ Makefile åŒæ ·ä¹Ÿæ ¹æ® .config ç»™å‡ºçš„é…ç½®ä¿¡æ¯ï¼Œæ„é€ å‡ºå½“å‰é…ç½®ä¸‹éœ€è¦çš„æºæ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶åœ¨æ–‡ä»¶çš„æœ€åæœ‰ include $(TOPDIR)/Rules.makeã€‚<br>&emsp;&emsp;Rules.make æ–‡ä»¶èµ·ç€éå¸¸é‡è¦çš„ä½œç”¨ï¼Œå®ƒå®šä¹‰äº†æ‰€æœ‰ Makefile å…±ç”¨çš„ç¼–è¯‘è§„åˆ™ã€‚æ¯”å¦‚ï¼Œå¦‚æœéœ€è¦å°†æœ¬ç›®å½•ä¸‹æ‰€æœ‰çš„ c ç¨‹åºç¼–è¯‘æˆæ±‡ç¼–ä»£ç ï¼Œéœ€è¦åœ¨ Makefile ä¸­æœ‰ä»¥ä¸‹çš„ç¼–è¯‘è§„åˆ™ï¼š</p><pre><code>%.s: %.c
    $(CC) $(CFLAGS) -S $&lt; -o $@</code></pre><p>&emsp;&emsp;æœ‰å¾ˆå¤šå­ç›®å½•ä¸‹éƒ½æœ‰åŒæ ·çš„è¦æ±‚ï¼Œå°±éœ€è¦åœ¨å„è‡ªçš„ Makefile ä¸­åŒ…å«æ­¤ç¼–è¯‘è§„åˆ™ï¼Œè¿™ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚è€Œ Linux å†…æ ¸ä¸­åˆ™æŠŠæ­¤ç±»çš„ç¼–è¯‘è§„åˆ™ç»Ÿä¸€æ”¾ç½®åˆ° Rules.make ä¸­ï¼Œå¹¶åœ¨å„è‡ªçš„ Makefile ä¸­åŒ…å«è¿›äº† Rules.makeï¼ˆinclude Rules.makeï¼‰ï¼Œè¿™æ ·å°±é¿å…äº†åœ¨å¤šä¸ª Makefile ä¸­é‡å¤åŒæ ·çš„è§„åˆ™ã€‚å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œåœ¨ Rules.make ä¸­å¯¹åº”çš„è§„åˆ™ä¸ºï¼š</p><pre><code>%.s: %.c
    $(CC) $(CFLAGS) $(EXTRA_CFLAGS) $(CFLAGS_$(*F)) $(CFLAGS_$@) -S $&lt; -o $@</code></pre><h2 id="Makefile-ä¸­çš„å˜é‡"><a href="#Makefile-ä¸­çš„å˜é‡" class="headerlink" title="Makefile ä¸­çš„å˜é‡"></a>Makefile ä¸­çš„å˜é‡</h2><p>&emsp;&emsp;é¡¶å±‚ Makefile å®šä¹‰å¹¶å‘ç¯å¢ƒä¸­è¾“å‡ºäº†è®¸å¤šå˜é‡ï¼Œä¸ºå„ä¸ªå­ç›®å½•ä¸‹çš„ Makefile ä¼ é€’ä¸€äº›ä¿¡æ¯ã€‚æœ‰äº›å˜é‡ï¼Œæ¯”å¦‚ SUBDIRSï¼Œä¸ä»…åœ¨é¡¶å±‚ Makefile ä¸­å®šä¹‰å¹¶ä¸”èµ‹åˆå€¼ï¼Œè€Œä¸”åœ¨ arch/*/Makefile è¿˜ä½œäº†æ‰©å……ã€‚</p><h3 id="å¸¸ç”¨çš„å˜é‡æœ‰ä»¥ä¸‹å‡ ç±»ï¼š"><a href="#å¸¸ç”¨çš„å˜é‡æœ‰ä»¥ä¸‹å‡ ç±»ï¼š" class="headerlink" title="å¸¸ç”¨çš„å˜é‡æœ‰ä»¥ä¸‹å‡ ç±»ï¼š"></a>å¸¸ç”¨çš„å˜é‡æœ‰ä»¥ä¸‹å‡ ç±»ï¼š</h3><h4 id="1ï¼‰-ç‰ˆæœ¬ä¿¡æ¯"><a href="#1ï¼‰-ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="1ï¼‰ ç‰ˆæœ¬ä¿¡æ¯"></a>1ï¼‰ ç‰ˆæœ¬ä¿¡æ¯</h4><p>&emsp;&emsp;ç‰ˆæœ¬ä¿¡æ¯æœ‰ï¼šVERSIONï¼ŒPATCHLEVEL, SUBLEVEL, EXTRAVERSIONï¼ŒKERNELRELEASEã€‚ç‰ˆæœ¬ä¿¡æ¯å®šä¹‰äº†å½“å‰å†…æ ¸çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚ VERSION=2ï¼ŒPATCHLEVEL=4ï¼ŒSUBLEVEL=18ï¼ŒEXATAVERSION=-rmk7ï¼Œå®ƒä»¬å…±åŒæ„æˆå†…æ ¸çš„å‘è¡Œç‰ˆæœ¬KERNELRELEASEï¼š2.4.18-rmk7</p><h4 id="2ï¼‰-CPU-ä½“ç³»ç»“æ„ï¼šARCH"><a href="#2ï¼‰-CPU-ä½“ç³»ç»“æ„ï¼šARCH" class="headerlink" title="2ï¼‰ CPU ä½“ç³»ç»“æ„ï¼šARCH"></a>2ï¼‰ CPU ä½“ç³»ç»“æ„ï¼šARCH</h4><p>&emsp;&emsp;åœ¨é¡¶å±‚ Makefile çš„å¼€å¤´ï¼Œç”¨ ARCH å®šä¹‰ç›®æ ‡ CPU çš„ä½“ç³»ç»“æ„ï¼Œæ¯”å¦‚ ARCH:=arm ç­‰ã€‚è®¸å¤šå­ç›®å½•çš„ Makefile ä¸­ï¼Œè¦æ ¹æ® ARCH çš„å®šä¹‰é€‰æ‹©ç¼–è¯‘æºæ–‡ä»¶çš„åˆ—è¡¨ã€‚</p><h4 id="3ï¼‰-è·¯å¾„ä¿¡æ¯ï¼šTOPDIR-SUBDIRS"><a href="#3ï¼‰-è·¯å¾„ä¿¡æ¯ï¼šTOPDIR-SUBDIRS" class="headerlink" title="3ï¼‰ è·¯å¾„ä¿¡æ¯ï¼šTOPDIR, SUBDIRS"></a>3ï¼‰ è·¯å¾„ä¿¡æ¯ï¼šTOPDIR, SUBDIRS</h4><p>&emsp;&emsp;TOPDIR å®šä¹‰äº† Linux å†…æ ¸æºä»£ç æ‰€åœ¨çš„æ ¹ç›®å½•ã€‚ä¾‹å¦‚ï¼Œå„ä¸ªå­ç›®å½•ä¸‹çš„ Makefile é€šè¿‡ $(TOPDIR)/Rules.make å°±å¯ä»¥æ‰¾åˆ° Rules.make çš„ä½ç½®ã€‚<br>&emsp;&emsp;SUBDIRS å®šä¹‰äº†ä¸€ä¸ªç›®å½•åˆ—è¡¨ï¼Œåœ¨ç¼–è¯‘å†…æ ¸æˆ–æ¨¡å—æ—¶ï¼Œé¡¶å±‚ Makefile å°±æ˜¯æ ¹æ® SUBDIRS æ¥å†³å®šè¿›å…¥å“ªäº›å­ç›®å½•ã€‚SUBDIRS çš„å€¼å–å†³äºå†…æ ¸çš„é…ç½®ï¼Œåœ¨é¡¶å±‚ Makefile ä¸­ SUBDIRS èµ‹å€¼ä¸º kernel drivers mm fs net ipc lib;æ ¹æ®å†…æ ¸çš„é…ç½®æƒ…å†µï¼Œåœ¨ arch/*/Makefile ä¸­æ‰©å……äº† SUBDIRSçš„å€¼ï¼Œå‚è§4)ä¸­çš„ä¾‹å­ã€‚</p><h4 id="4ï¼‰-å†…æ ¸ç»„æˆä¿¡æ¯ï¼šHEAD-CORE-FILES-NETWORKS-DRIVERS-LIBS"><a href="#4ï¼‰-å†…æ ¸ç»„æˆä¿¡æ¯ï¼šHEAD-CORE-FILES-NETWORKS-DRIVERS-LIBS" class="headerlink" title="4ï¼‰ å†…æ ¸ç»„æˆä¿¡æ¯ï¼šHEAD, CORE_FILES, NETWORKS, DRIVERS, LIBS"></a>4ï¼‰ å†…æ ¸ç»„æˆä¿¡æ¯ï¼šHEAD, CORE_FILES, NETWORKS, DRIVERS, LIBS</h4><p>Linux å†…æ ¸æ–‡ä»¶ vmlinux æ˜¯ç”±ä»¥ä¸‹è§„åˆ™äº§ç”Ÿçš„ï¼š</p><pre><code>vmlinux: $(CONFIGURATION) init/main.o init/version.o linuxsubdirs
$(LD) $(LINKFLAGS) $(HEAD) init/main.o init/version.o \
    --start-group \
    x$(CORE_FILES) \
    $(DRIVERS) \
    $(NETWORKS) \
    $(LIBS) \
    --end-group \
    -o vmlinux</code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œvmlinux æ˜¯ç”± HEADã€main.oã€version.oã€CORE_FILESã€DRIVERSã€NETWORKS å’Œ LIBS ç»„æˆçš„ã€‚è¿™äº›å˜é‡ï¼ˆå¦‚ HEADï¼‰éƒ½æ˜¯ç”¨æ¥å®šä¹‰è¿æ¥ç”Ÿæˆ vmlinux çš„ç›®æ ‡æ–‡ä»¶å’Œåº“æ–‡ä»¶åˆ—è¡¨ã€‚å…¶ä¸­ï¼ŒHEADåœ¨arch/*/Makefile ä¸­å®šä¹‰ï¼Œç”¨æ¥ç¡®å®šè¢«æœ€å…ˆé“¾æ¥è¿› vmlinux çš„æ–‡ä»¶åˆ—è¡¨ã€‚æ¯”å¦‚ï¼Œå¯¹äº ARM ç³»åˆ—çš„ CPUï¼ŒHEAD å®šä¹‰ä¸ºï¼š</p><pre><code>HEAD := arch/arm/kernel/head-$(PROCESSOR).o \
    arch/arm/kernel/init_task.o</code></pre><p>è¡¨æ˜ head-$(PROCESSOR).o å’Œ init_task.o éœ€è¦æœ€å…ˆè¢«é“¾æ¥åˆ° vmlinux ä¸­ã€‚PROCESSOR ä¸º armv æˆ– armoï¼Œå–å†³äºç›®æ ‡ CPUã€‚CORE_FILESï¼ŒNETWORKï¼ŒDRIVERS å’Œ LIBS åœ¨é¡¶å±‚ Makefile ä¸­å®šä¹‰ï¼Œå¹¶ä¸”ç”± arch/*/Makefile æ ¹æ®éœ€è¦è¿›è¡Œæ‰©å……ã€‚CORE_FILES å¯¹åº”ç€å†…æ ¸çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œæœ‰ kernel/kernel.oï¼Œmm/mm.oï¼Œfs/fs.oï¼Œipc/ipc.oï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›æ˜¯ç»„æˆå†…æ ¸æœ€ä¸ºé‡è¦çš„æ–‡ä»¶ã€‚åŒæ—¶ï¼Œarch/arm/Makefile å¯¹ CORE_FILES è¿›è¡Œäº†æ‰©å……ï¼š</p><pre><code>    # arch/arm/Makefile
    # If we have a machine-specific directory, then include it in the build.
    MACHDIR         := arch/arm/mach-$(MACHINE)
    ifeq ($(MACHDIR),$(wildcard $(MACHDIR)))
    SUBDIRS         += $(MACHDIR)
    CORE_FILES      := $(MACHDIR)/$(MACHINE).o $(CORE_FILES)
    endif
    HEAD            := arch/arm/kernel/head-$(PROCESSOR).o \
                       arch/arm/kernel/init_task.o
    SUBDIRS         += arch/arm/kernel arch/arm/mm arch/arm/lib arch/arm/nwfpe
    CORE_FILES      := arch/arm/kernel/kernel.o arch/arm/mm/mm.o $(CORE_FILES)
    LIBS            := arch/arm/lib/lib.a $(LIBS)</code></pre><h4 id="5ï¼‰-ç¼–è¯‘ä¿¡æ¯ï¼šCPP-CC-AS-LD-ARï¼ŒCFLAGSï¼ŒLINKFLAGS"><a href="#5ï¼‰-ç¼–è¯‘ä¿¡æ¯ï¼šCPP-CC-AS-LD-ARï¼ŒCFLAGSï¼ŒLINKFLAGS" class="headerlink" title="5ï¼‰ ç¼–è¯‘ä¿¡æ¯ï¼šCPP, CC, AS, LD, ARï¼ŒCFLAGSï¼ŒLINKFLAGS"></a>5ï¼‰ ç¼–è¯‘ä¿¡æ¯ï¼šCPP, CC, AS, LD, ARï¼ŒCFLAGSï¼ŒLINKFLAGS</h4><p>åœ¨ Rules.make ä¸­å®šä¹‰çš„æ˜¯ç¼–è¯‘çš„é€šç”¨è§„åˆ™ï¼Œå…·ä½“åˆ°ç‰¹å®šçš„åœºåˆï¼Œéœ€è¦æ˜ç¡®ç»™å‡ºç¼–è¯‘ç¯å¢ƒï¼Œç¼–è¯‘ç¯å¢ƒå°±æ˜¯åœ¨ä»¥ä¸Šçš„å˜é‡ä¸­å®šä¹‰çš„ã€‚é’ˆå¯¹äº¤å‰ç¼–è¯‘çš„è¦æ±‚ï¼Œå®šä¹‰äº† CROSS_COMPILEã€‚æ¯”å¦‚ï¼š</p><pre><code>CROSS_COMPILE = arm-linux-
    CC = $(CROSS_COMPILE)gcc
    LD = $(CROSS_COMPILE)ld
    ......</code></pre><p>CROSS_COMPILE å®šä¹‰äº†äº¤å‰ç¼–è¯‘å™¨å‰ç¼€ arm-linux-ï¼Œè¡¨æ˜æ‰€æœ‰çš„äº¤å‰ç¼–è¯‘å·¥å…·éƒ½æ˜¯ä»¥ arm-linux- å¼€å¤´çš„ï¼Œæ‰€ä»¥åœ¨å„ä¸ªäº¤å‰ç¼–è¯‘å™¨å·¥å…·ä¹‹å‰ï¼Œéƒ½åŠ å…¥äº† $(CROSS_COMPILE)ï¼Œä»¥ç»„æˆä¸€ä¸ªå®Œæ•´çš„äº¤å‰ç¼–è¯‘å·¥å…·æ–‡ä»¶åï¼Œæ¯”å¦‚ arm-linux-gccã€‚<br>&emsp;&emsp;CFLAGS å®šä¹‰äº†ä¼ é€’ç»™ C ç¼–è¯‘å™¨çš„å‚æ•°ã€‚<br>&emsp;&emsp;LINKFLAGS æ˜¯é“¾æ¥ç”Ÿæˆ vmlinux æ—¶ï¼Œç”±é“¾æ¥å™¨ä½¿ç”¨çš„å‚æ•°ã€‚LINKFLAGS åœ¨ arm/*/Makefile ä¸­å®šä¹‰ï¼Œæ¯”å¦‚ï¼š</p><pre><code> # arch/arm/Makefile
    LINKFLAGS :=-p -X -T arch/arm/vmlinux.lds</code></pre><h4 id="6ï¼‰-é…ç½®å˜é‡CONFIG"><a href="#6ï¼‰-é…ç½®å˜é‡CONFIG" class="headerlink" title="6ï¼‰ é…ç½®å˜é‡CONFIG_*"></a>6ï¼‰ é…ç½®å˜é‡CONFIG_*</h4><p>&emsp;&emsp;.config æ–‡ä»¶ä¸­æœ‰è®¸å¤šçš„é…ç½®å˜é‡ç­‰å¼ï¼Œç”¨æ¥è¯´æ˜ç”¨æˆ·é…ç½®çš„ç»“æœã€‚ä¾‹å¦‚ CONFIG_MODULES=y è¡¨æ˜ç”¨æˆ·é€‰æ‹©äº† Linux å†…æ ¸çš„æ¨¡å—åŠŸèƒ½ã€‚<br>&emsp;&emsp;.config è¢«é¡¶å±‚ Makefile åŒ…å«åï¼Œå°±å½¢æˆè®¸å¤šçš„é…ç½®å˜é‡ï¼Œæ¯ä¸ªé…ç½®å˜é‡å…·æœ‰ç¡®å®šçš„å€¼ï¼šy è¡¨ç¤ºæœ¬ç¼–è¯‘é€‰é¡¹å¯¹åº”çš„å†…æ ¸ä»£ç è¢«é™æ€ç¼–è¯‘è¿› Linux å†…æ ¸;m è¡¨ç¤ºæœ¬ç¼–è¯‘é€‰é¡¹å¯¹åº”çš„å†…æ ¸ä»£ç è¢«ç¼–è¯‘æˆæ¨¡å—;n è¡¨ç¤ºä¸é€‰æ‹©æ­¤ç¼–è¯‘é€‰é¡¹;å¦‚æœæ ¹æœ¬å°±æ²¡æœ‰é€‰æ‹©ï¼Œé‚£ä¹ˆé…ç½®å˜é‡çš„å€¼ä¸ºç©ºã€‚</p><h2 id="Rules-make-å˜é‡"><a href="#Rules-make-å˜é‡" class="headerlink" title="Rules.make å˜é‡"></a>Rules.make å˜é‡</h2><p>&emsp;&emsp;å‰é¢è®²è¿‡ï¼ŒRules.make æ˜¯ç¼–è¯‘è§„åˆ™æ–‡ä»¶ï¼Œæ‰€æœ‰çš„ Makefile ä¸­éƒ½ä¼šåŒ…æ‹¬ Rules.makeã€‚Rules.make æ–‡ä»¶å®šä¹‰äº†è®¸å¤šå˜é‡ï¼Œæœ€ä¸ºé‡è¦æ˜¯é‚£äº›ç¼–è¯‘ã€é“¾æ¥åˆ—è¡¨å˜é‡ã€‚<br>&emsp;&emsp;O_OBJSï¼ŒL_OBJSï¼ŒOX_OBJSï¼ŒLX_OBJSï¼šæœ¬ç›®å½•ä¸‹éœ€è¦ç¼–è¯‘è¿› Linux å†…æ ¸ vmlinux çš„ç›®æ ‡æ–‡ä»¶åˆ—è¡¨ï¼Œå…¶ä¸­ OX_OBJS å’Œ LX_OBJS ä¸­çš„ â€œXâ€ è¡¨æ˜ç›®æ ‡æ–‡ä»¶ä½¿ç”¨äº† EXPORT_SYMBOL è¾“å‡ºç¬¦å·ã€‚<br>&emsp;&emsp;M_OBJSï¼ŒMX_OBJSï¼šæœ¬ç›®å½•ä¸‹éœ€è¦è¢«ç¼–è¯‘æˆå¯è£…è½½æ¨¡å—çš„ç›®æ ‡æ–‡ä»¶åˆ—è¡¨ã€‚åŒæ ·ï¼ŒMX_OBJS ä¸­çš„ â€œXâ€ è¡¨æ˜ç›®æ ‡æ–‡ä»¶ä½¿ç”¨äº† EXPORT_SYMBOL è¾“å‡ºç¬¦å·ã€‚<br>&emsp;&emsp;O_TARGETï¼ŒL_TARGETï¼šæ¯ä¸ªå­ç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ª O_TARGET æˆ– L_TARGETï¼ŒRules.make é¦–å…ˆä»æºä»£ç ç¼–è¯‘ç”Ÿæˆ O_OBJS å’Œ OX_OBJS ä¸­æ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ $(LD) -r æŠŠå®ƒä»¬é“¾æ¥æˆä¸€ä¸ª O_TARGET æˆ– L_TARGETã€‚O_TARGET ä»¥ .o ç»“å°¾ï¼Œè€Œ L_TARGET ä»¥ .a ç»“å°¾ã€‚</p><h2 id="å­ç›®å½•-Makefile"><a href="#å­ç›®å½•-Makefile" class="headerlink" title="å­ç›®å½• Makefile"></a>å­ç›®å½• Makefile</h2><p>&emsp;&emsp;å­ç›®å½• Makefile ç”¨æ¥æ§åˆ¶æœ¬çº§ç›®å½•ä»¥ä¸‹æºä»£ç çš„ç¼–è¯‘è§„åˆ™ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è®²è§£å­ç›®å½• Makefile çš„ç»„æˆï¼š</p><pre><code>#
    # Makefile for the linux kernel.
    #
    # All of the (potential) objects that export symbols.
    # This list comes from &#39;grep -l EXPORT_SYMBOL *.[hc]&#39;.
    export-objs := tc.o
    # Object file lists.
    obj-y        :=
    obj-m        :=
    obj-n        :=
    obj-         :=
    obj-$(CONFIG_TC) += tc.o
    obj-$(CONFIG_ZS) += zs.o
    obj-$(CONFIG_VT) += lk201.o lk201-map.o lk201-remap.o
    # Files that are both resident and modular: remove from modular.
    obj-m        := $(filter-out $(obj-y), $(obj-m))
    # Translate to Rules.make lists.
    L_TARGET := tc.a
    L_OBJS       := $(sort $(filter-out $(export-objs), $(obj-y)))
    LX_OBJS      := $(sort $(filter     $(export-objs), $(obj-y)))
    M_OBJS       := $(sort $(filter-out $(export-objs), $(obj-m)))
    MX_OBJS      := $(sort $(filter     $(export-objs), $(obj-m)))
    include $(TOPDIR)/Rules.make</code></pre><p>a) æ³¨é‡Š<br>&emsp;&emsp;å¯¹ Makefile çš„è¯´æ˜å’Œè§£é‡Šï¼Œç”±#å¼€å§‹ã€‚<br>b) ç¼–è¯‘ç›®æ ‡å®šä¹‰<br>&emsp;&emsp;ç±»ä¼¼äº obj-$(CONFIG_TC) += tc.o çš„è¯­å¥æ˜¯ç”¨æ¥å®šä¹‰ç¼–è¯‘çš„ç›®æ ‡ï¼Œæ˜¯å­ç›®å½• Makefile ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚ç¼–è¯‘ç›®æ ‡å®šä¹‰é‚£äº›åœ¨æœ¬å­ç›®å½•ä¸‹ï¼Œéœ€è¦ç¼–è¯‘åˆ° Linux å†…æ ¸ä¸­çš„ç›®æ ‡æ–‡ä»¶åˆ—è¡¨ã€‚ä¸ºäº†åªåœ¨ç”¨æˆ·é€‰æ‹©äº†æ­¤åŠŸèƒ½åæ‰ç¼–è¯‘ï¼Œæ‰€æœ‰çš„ç›®æ ‡å®šä¹‰éƒ½èåˆäº†å¯¹é…ç½®å˜é‡çš„åˆ¤æ–­ã€‚<br>&emsp;&emsp;å‰é¢è¯´è¿‡ï¼Œæ¯ä¸ªé…ç½®å˜é‡å–å€¼èŒƒå›´æ˜¯ï¼šyï¼Œnï¼Œm å’Œç©ºï¼Œobj-$(CONFIG_TC) åˆ†åˆ«å¯¹åº”ç€ obj-yï¼Œobj-nï¼Œobj-mï¼Œobj-ã€‚å¦‚æœ CONFIG_TC é…ç½®ä¸º yï¼Œé‚£ä¹ˆ tc.o å°±è¿›å…¥äº† obj-y åˆ—è¡¨ã€‚obj-y ä¸ºåŒ…å«åˆ° Linux å†…æ ¸ vmlinux ä¸­çš„ç›®æ ‡æ–‡ä»¶åˆ—è¡¨;obj-m ä¸ºç¼–è¯‘æˆæ¨¡å—çš„ç›®æ ‡æ–‡ä»¶åˆ—è¡¨;obj-n å’Œ obj- ä¸­çš„æ–‡ä»¶åˆ—è¡¨è¢«å¿½ç•¥ã€‚é…ç½®ç³»ç»Ÿå°±æ ¹æ®è¿™äº›åˆ—è¡¨çš„å±æ€§è¿›è¡Œç¼–è¯‘å’Œé“¾æ¥ã€‚<br>&emsp;&emsp;export-objs ä¸­çš„ç›®æ ‡æ–‡ä»¶éƒ½ä½¿ç”¨äº† EXPORT_SYMBOL() å®šä¹‰äº†å…¬å…±çš„ç¬¦å·ï¼Œä»¥ä¾¿å¯è£…è½½æ¨¡å—ä½¿ç”¨ã€‚åœ¨ tc.c æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œæœ‰ â€œEXPORT_SYMBOL(search_tc_card);â€ï¼Œè¡¨æ˜ tc.o æœ‰ç¬¦å·è¾“å‡ºã€‚<br>&emsp;&emsp;è¿™é‡Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œå¯¹äºç¼–è¯‘ç›®æ ‡çš„å®šä¹‰ï¼Œå­˜åœ¨ç€ä¸¤ç§æ ¼å¼ï¼Œåˆ†åˆ«æ˜¯è€å¼å®šä¹‰å’Œæ–°å¼å®šä¹‰ã€‚è€å¼å®šä¹‰å°±æ˜¯å‰é¢ Rules.make ä½¿ç”¨çš„é‚£äº›å˜é‡ï¼Œæ–°å¼å®šä¹‰å°±æ˜¯ obj-yï¼Œobj-mï¼Œobj-n å’Œ obj-ã€‚Linux å†…æ ¸æ¨èä½¿ç”¨æ–°å¼å®šä¹‰ï¼Œä¸è¿‡ç”±äº Rules.make ä¸ç†è§£æ–°å¼å®šä¹‰ï¼Œéœ€è¦åœ¨ Makefile ä¸­çš„é€‚é…æ®µå°†å…¶è½¬æ¢æˆè€å¼å®šä¹‰ã€‚<br>c) é€‚é…æ®µ<br>&emsp;&emsp;é€‚é…æ®µçš„ä½œç”¨æ˜¯å°†æ–°å¼å®šä¹‰è½¬æ¢æˆè€å¼å®šä¹‰ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé€‚é…æ®µå°±æ˜¯å°† obj-y å’Œ obj-m è½¬æ¢æˆ Rules.make èƒ½å¤Ÿç†è§£çš„ L_TARGETï¼ŒL_OBJSï¼ŒLX_OBJSï¼ŒM_OBJSï¼ŒMX_OBJSã€‚<br>&emsp;&emsp;L_OBJS := $(sort $(filter-out $(export-objs), $(obj-y))) å®šä¹‰äº† L_OBJS çš„ç”Ÿæˆæ–¹å¼ï¼šåœ¨ obj-y çš„åˆ—è¡¨ä¸­è¿‡æ»¤æ‰ export-objs(tc.o)ï¼Œç„¶åæ’åºå¹¶å»é™¤é‡å¤çš„æ–‡ä»¶åã€‚è¿™é‡Œä½¿ç”¨åˆ°äº† GNU Make çš„ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½ï¼Œå…·ä½“çš„å«ä¹‰å¯å‚è€ƒ Make çš„æ–‡æ¡£(info make)ã€‚<br>d) include $(TOPDIR)/Rules.make</p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">æ–‡ç« ä½œè€…: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">xiangyi</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">æ–‡ç« é“¾æ¥: </i></span><span class="reprint-info"><a href="xiangyi0715.github.io/posts/fe83.html">xiangyi0715.github.io/posts/fe83.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">ç‰ˆæƒå£°æ˜: </i></span><span class="reprint-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="/about" target="_blank">xiangyi</a> !</span></div></div><script async defer>document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/%E8%BD%AC%E8%BD%BD/"><span class="chip bg-color">è½¬è½½</span> </a><a href="/tags/makefile/"><span class="chip bg-color">makefile</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22AB38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019FE8!important}.reward-tabs .reward-img{width:210px;height:210px}.wpac-rating{position:absolute;right:0;width:300px;border:3px solid #73AD21;padding:10px}</style><div id="wpac-rating"></div><script type="text/javascript">wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:25443}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://embed.widgetpack.com/widget.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e.nextSibling)}}()</script><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li></ul><div id="alipay"><img src="/medias/reward/alipay.png" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç "></div><div id="wechat"><img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç "></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/comment_bg.gif) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>è¯„è®º</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="/libs/valine/av-min.js"></script><script src="/libs/valine/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"jr5W4kBd51lUgWuddG9tyYg9-gzGzoHsz",appKey:"QP5tgocv5CBPAsr7NzCbIq1W",notify:!0,verify:!1,visitor:!0,avatar:"wavatar",pageSize:"30",lang:"zh-cn",placeholder:"just go go"})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div><div class="card"><a href="/posts/3eeb.html"><div class="card-image"><img src="/medias/featureimages/12.jpg" class="responsive-img" alt="Hello World"> <span class="card-title">Hello World</span></div></a><div class="card-content article-content"><div class="summary block-with-text">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hex</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-05-29 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%86%85%E7%BD%AE/" class="post-category">å†…ç½®</a></span></div></div><div class="card-action article-tags"><a href="/tags/%E5%86%85%E7%BD%AE/"><span class="chip bg-color">å†…ç½®</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/20c9.html"><div class="card-image"><img src="/medias/featureimages/10.jpg" class="responsive-img" alt="å…³äºGrideaä¸»é¢˜â€”â€”ChicUnique"> <span class="card-title">å…³äºGrideaä¸»é¢˜â€”â€”ChicUnique</span></div></a><div class="card-content article-content"><div class="summary block-with-text">ğŸŒ»Gridea-Chic-Uniqueè¿™ä¸ªä¸»é¢˜ç”±ITJoker233çš„Gridea-theme-Chicåšæ›´æ”¹ï¼Œé€‚åˆä¸ªäººä½¿ç”¨ã€‚æœ¬ä¸»é¢˜åªåšåˆ°èƒ½ç”¨å³å¯ã€‚åç§°ç”±æ¥ï¼šChicâ€”ä¼˜é›…ï¼›Uniqueâ€”ç‹¬ç‰¹ã€‚é¢„è§ˆ æˆ‘çš„ä¸»é¡µğŸ¯åŸChicä¸»é¢˜å·²æœ‰åŠŸèƒ½ä¸ç‰¹</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-04-01 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E7%AC%94%E8%AE%B0/" class="post-category">ç¬”è®°</a></span></div></div><div class="card-action article-tags"><a href="/tags/%E5%8E%9F%E5%88%9B/"><span class="chip bg-color">åŸåˆ›</span> </a><a href="/tags/gridea/"><span class="chip bg-color">gridea</span> </a><a href="/tags/chic-unique/"><span class="chip bg-color">chic_unique</span> </a><a href="/tags/theme/"><span class="chip bg-color">theme</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){if("undefined"!=typeof window.getSelection){var n=window.getSelection();if(!((""+n).length<Number.parseInt("20"))){var t=document.getElementsByTagName("body")[0],o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"===n.getRangeAt(0).commonAncestorContainer.nodeName&&(o.innerHTML="<pre>"+o.innerHTML+"</pre>");var i=document.location.href;o.innerHTML+='<br />æ¥æº: xiangyi<br />æ–‡ç« ä½œè€…: xiangyi<br />æ–‡ç« é“¾æ¥: <a href="'+i+'">'+i+"</a><br />æœ¬æ–‡ç« è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½éƒ½è¯·æ³¨æ˜å‡ºå¤„ã€‚",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200)}}})</script><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020</span> <a href="/about" target="_blank">xiangyi</a> |&nbsp;åŸºäº&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;ä¸»é¢˜&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span class="white-color">32.8k</span>&nbsp;å­— <span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;æ¬¡ </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;äºº</span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/xiangyi715" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:978270268@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=978270268" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 978270268" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="https://www.zhihu.com/people/xiangyi715" class="tooltipped" target="_blank" data-tooltip="å…³æ³¨æˆ‘çš„çŸ¥ä¹: https://www.zhihu.com/people/xiangyi715" data-position="top" data-delay="50"><i class="fab fa-zhihu1">çŸ¥</i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><script type="text/javascript" src="/js/linkcard.js"></script><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span> <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—" class="search-input"></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">$(function(){searchFunc("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?8d4491bf7d774389d2e2dac1625bcf3f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script src="/libs/instantpage/instantpage.js" type="module"></script></body></html><!-- rebuild by neat -->